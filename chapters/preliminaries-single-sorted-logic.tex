\section{Single-sorted first-order logic}\label{sec:defs-single-sorted}

\begin{definition}[First-order vocabulary and syntax]
A \emph{first-order vocabulary} (or \emph{language}) $\mathcal{L}$ consists of:
\begin{enumerate}
  \item For each $n \ge 0$, a (possibly empty) set of $n$-ary \emph{function symbols}.
        We use $f,g,h,\dots$ as meta-variables for function symbols.
        A $0$-ary function symbol is called a \emph{constant symbol};
  \item For each $n \ge 0$, a set of $n$-ary \emph{predicate symbols}, which is
        nonempty for at least one $n$.
        We use $P,Q,R,\dots$ as meta-variables for predicate symbols.
\end{enumerate}

In addition, the following logical symbols are available to build first-order
terms and formulas:
\begin{enumerate}
  \item An infinite set of \emph{variables}. We use $x,y,z,\dots$ and sometimes
        $a,b,c,\dots$ as meta-variables for variables;
  \item The connectives $\lnot$, $\land$, $\lor$ (not, and, or) and
        logical constants $\bot$, $\top$ (false, true);\todo{consistency: semicolon in enumerate}
  \item The quantifiers $\forall$, $\exists$ (for all, there exists);
  \item Parentheses $(\, ,\,)$.
\end{enumerate}
\end{definition}

\begin{remark}
Note that we don't introduce the equality sign $=$ as a special symbol in the vocabulary. We will treat
equality as a standard binary relation and only require it to be treated specially when
reasoning about semantics.
\end{remark}


% Równość w FO: Zazwyczaj (o ile nie chcemy czegoś mówić o FO bez równości, co zdarza się bardzo rzadko) 
% zakłada się, że równość nie jest specjalnym symbolem relacyjnym, ale jest po prostu dostępna w składni.
% Więc w def. 2.1.1 oraz 2.1.3 dodatkowo równość, a w def. 2.1.4 nie.
% Choć tak jak teraz też potencjalnie może być. Jest to jakoś trochę wyjaśnione w Remark 2.2. Ale może
% pasowałoby coś wspomnieć (że równość będziemy traktowali jak zwykłą relację) już po def. 2.1.1 - inaczej
% jak człowiek czyta to nabiera podejrzeń że coś jest źle.

% Whenever the symbol $=$ appears in a vocabulary, it is treated just like any other predicate symbol at the syntactic level; the semantic clause in \autoref{def:L-structure} below will enforce that it always denotes actual equality on the universe.


% Expressive power of different possibilities
% \item $\text{FO}[+, *] = \text{FO}[\mathrm{BIT}]: Section~1.2.1 Immerman $.
% \item $\text{FO}[+]$ is less expressive than $\text{FO}[<, *] = \text{FO}[<, /] = \text{FO}[<, \mathrm{COPRIME}]$~\cite{10.1002/malq.200310041}.


\begin{definition}[$\mathcal{L}$-terms]
Let $\mathcal{L}$ be a first-order vocabulary.
The set of \emph{$\mathcal{L}$-terms} is defined inductively as follows:
\begin{enumerate}
  \item Every variable is an $\mathcal{L}$-term;
  \item If $f$ is an $n$-ary function symbol of $\mathcal{L}$ and
        $t_1,\dots,t_n$ are $\mathcal{L}$-terms, then
        \[
          f(t_1,\dots,t_n)
        \]
        is an $\mathcal{L}$-term.
\end{enumerate}
\end{definition}

\begin{definition}[$\mathcal{L}$-formulas]
Let $\mathcal{L}$ be a first-order vocabulary.
The set of \emph{first-order formulas in $\mathcal{L}$} (or
\emph{$\mathcal{L}$-formulas}) is defined
inductively as follows:
\begin{enumerate}
  \item The logical constants $\bot$ and $\top$ are atomic formulas;
  \item If $P$ is an $n$-ary predicate symbol in $\mathcal{L}$ and
        $t_1,\dots,t_n$ are $\mathcal{L}$-terms, then
        \[
          P(t_1,\dots,t_n)
        \]
        is an \emph{atomic} $\mathcal{L}$-formula;
  \item If $\varphi$ and $\psi$ are $\mathcal{L}$-formulas, then
        $\lnot \varphi$, $(\varphi \land \psi)$, and $(\varphi \lor \psi)$ are $\mathcal{L}$-formulas;
  \item If $\varphi$ is an $\mathcal{L}$-formula and $x$ is a variable, then
        $\forall x\ldotp \varphi$ and $\exists x\ldotp \varphi$ are $\mathcal{L}$-formulas.
\end{enumerate}
% Przykład pod 2.1.3: wcześniej było P(t1,...,tn) z nawiasami a tutaj Px bez nawiasów.
% Niech będzie spójnie. W "Pfyz" nie wiadomo czy y,z idą do f czy do P. Z arności P wynika,
% że y do f, a z do P. Raczej z nawiasami. Poza tym w drugiej formule inna litera zamiast P
% (obecnie nie mogą obie formuły na raz być L-formułami dla żadnego L, bo raz P unarne a raz binarne).
For example,
\[
  (\lnot \forall x\ldotp P(x) \,\lor\, \exists x\ldotp \lnot P(x))
  \quad\text{and}\quad
  (\forall x\ldotp \lnot Q(x,f(y)) \,\land\, \lnot \forall z\ldotp Q(f(y),z))
\]
are $\mathcal{L}$-formulas (for suitable choices of $P$, $Q$, and $f$ in $\mathcal{L}$).
\end{definition}

\begin{definition}[The language of arithmetic]\label{def:LA}
The \emph{language of arithmetic} is
\[
  L_{A} = [\,0,\,1,\,+,\,\cdot \;;\; =,\,\le\,],
\]
where \(0\) and \(1\) are constant symbols, \(+\) and \(\cdot\) are binary
function symbols, and \(=\) and \(\le\) are binary predicate symbols.
We will write these symbols in infix form.
\end{definition}

\begin{definition}[Free and bound variables]\label{def:free-bound}
Let $\varphi$ be a formula and $x$ a variable.
An occurrence of $x$ in $\varphi$ is \emph{bound} if it lies within a subformula
of $\varphi$ of the form $\forall x\ldotp \psi$ or $\exists x\ldotp \psi$.
Any other occurrence of $x$ in $\varphi$ is called \emph{free}.
\end{definition}

\begin{definition}[Closed terms, closed formulas, sentences]\label{def:closed-sentence}
A formula is \emph{closed} if it contains no free occurrence of any variable.
A term is \emph{closed} if it contains no variables at all.
A closed formula is also called a \emph{sentence}.
\end{definition}

\begin{definition}[$\mathcal{L}$-structure]\label{def:L-structure}
Let $\mathcal{L}$ be a first-order vocabulary.
An \emph{$\mathcal{L}$-structure} $\mathcal{M}$ consists of:
\begin{enumerate}
  \item A nonempty set $M$, called the \emph{universe}
        (variables are intended to range over $M$);
  \item For each $n$-ary function symbol $f$ in $\mathcal{L}$, an associated function
        \(
          f^{\mathcal{M}} : M^n \to M
        \);
  \item For each $n$-ary predicate symbol $P$ in $\mathcal{L}$, an associated relation
        \(
          P^{\mathcal{M}} \subseteq M^n
        \).
\end{enumerate}
\end{definition}

\begin{remark}
    Note that to ``syntactical'' relations, we assign ``real'' relations defined on
    the underlying elements of the structure. We will want to treat some of these
    relations specially, e.g.\ to make sure that the ``\(=\)'' relation is
    interpreted as the actual equality, or that a designated ``\(\text{PLUS}(x, y, z)\)''
    relation holds only if the underlying objects are actual natural numbers,
    for which we have $x + y = z$. \todo{add autoref to where we talk about that}
% Thus the predicate symbol $=$ receives special treatment: it must always be
% interpreted as actual equality on the universe. We can also consider
% logics where we don't take the $=$ symbol as granted. For our purposes, however,
% the things we will be able to say about the class of models of a given formula
% will be more interesting if we already assume that whenever $p = q$ holds
% in the structure, then the underlying objects of the universe are also equal
% (in the meta-mathematical sense).
\end{remark}


\begin{definition}[Object Assignment]
Let $\mathcal{M}$ be a structure with universe $M$.  
An \emph{object assignment} \(\sigma\) for $\mathcal{M}$ is a mapping
from variables to the universe $M$.
\end{definition}

\begin{notation}
Let $x$ be a variable and $m \in M$.  
We write $\sigma(m/x)$ for the
assignment that is the same as $\sigma$ except that it maps $x$ to $m$.
\end{notation}

% Def. 2.1.9 (iii): - a tu jednak = nie jest relacją w M, ale jest traktowane specjalnie.
\begin{definition}[Basic Semantic Definition]
Let $\mathcal{L}$ be a first-order vocabulary, let $\mathcal{M}$ be an $\mathcal{L}$-structure
with universe $M$, and let $\sigma$ be an object assignment for $\mathcal{M}$.

\paragraph{Interpretation of terms.}
Each $\mathcal{L}$-term $t$ is assigned an element $t^{\mathcal{M}}[\sigma] \in M$,
defined by structural induction on $t$:
\begin{enumerate}
  \item For each variable $x$,
  \(
    x^{\mathcal{M}}[\sigma] = \sigma(x).
  \)
  % TODO: In particular, we only work with semantics in which the distinguished predicate symbol $=$ is interpreted as genuine equality on $M$; we do not consider variants where it could denote another equivalence relation.
  \item 
  \(
    (f t_1 \dots t_n)^{\mathcal{M}}[\sigma]
      = f^{\mathcal{M}}\bigl(t_1^{\mathcal{M}}[\sigma],\dots,t_n^{\mathcal{M}}[\sigma]\bigr).
  \)
\end{enumerate}

\paragraph{Satisfaction of formulas.}
For an $\mathcal{L}$-formula $\varphi$, the relation
\[
  \mathcal{M} \models \varphi[\sigma]
\]
(read: ``$\mathcal{M}$ satisfies $\varphi$ under $\sigma$'') is defined by structural
induction on $\varphi$:
\begin{enumerate}
  \item $\mathcal{M} \models \top[\sigma]$ and $\mathcal{M} \not\models \bot[\sigma]$.
  \item For an atomic formula $P t_1 \dots t_n$ (with $P$ an $n$-ary
        predicate symbol),
  \[
    \mathcal{M} \models (P t_1 \dots t_n)[\sigma]
    \;\;\text{iff}\;\;
    \bigl\langle t_1^{\mathcal{M}}[\sigma],\dots,t_n^{\mathcal{M}}[\sigma]\bigr\rangle
    \in P^{\mathcal{M}}.
  \]
  \item If $\mathcal{L}$ contains $=$, then for terms $s,t$,
  \[
    \mathcal{M} \models (s = t)[\sigma]
    \;\;\text{iff}\;\;
    s^{\mathcal{M}}[\sigma] = t^{\mathcal{M}}[\sigma].
  \]
  \item $\mathcal{M} \models \neg \varphi[\sigma]$ iff $\mathcal{M} \not\models \varphi[\sigma]$.
  \item $\mathcal{M} \models (\varphi \lor \psi)[\sigma]$ iff
        $\mathcal{M} \models \varphi[\sigma]$ or $\mathcal{M} \models \psi[\sigma]$.
  \item $\mathcal{M} \models (\varphi \land \psi)[\sigma]$ iff
        $\mathcal{M} \models \varphi[\sigma]$ and $\mathcal{M} \models \psi[\sigma]$.
  \item $\mathcal{M} \models (\forall x\ldotp \varphi)[\sigma]$ iff
        $\mathcal{M} \models \varphi[\sigma(m/x)]$ for all $m \in M$.
  \item $\mathcal{M} \models (\exists x\ldotp \varphi)[\sigma]$ iff
        $\mathcal{M} \models \varphi[\sigma(m/x)]$ for some $m \in M$.
\end{enumerate}

\noindent
If $t$ is a closed term, then $t^{\mathcal{M}}[\sigma]$
is independent of $\sigma$, and we simply write $t^{\mathcal{M}}$.
Similarly, if $\varphi$ is a sentence, we often write
$\mathcal{M} \models \varphi$ instead of $\mathcal{M} \models \varphi[\sigma]$, since
the choice of $\sigma$ does not matter.
\end{definition}
